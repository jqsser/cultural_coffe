<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/21.0.2" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="tn.esprit.controllers.ChatController" stylesheets="@styles.css">

    <!-- Left Side - Matching List with Search and Add Button -->
    <left>
        <VBox prefWidth="300" spacing="10" style="-fx-background-color: #f8f9fa;">
            <!-- Title and 3D Coffee Button -->
            <HBox alignment="CENTER" spacing="10" style="-fx-padding: 10;">
                <Label text="Matchings" style="-fx-font-size: 18; -fx-font-weight: bold;"/>
                <Button text="3D Coffee" styleClass="secondary-button" onAction="#handle3DCoffee"/>
            </HBox>

            <!-- Search Form -->
            <HBox spacing="5" style="-fx-padding: 0 10 10 10;">
                <TextField fx:id="searchField" promptText="Search matchings..." styleClass="search-field" HBox.hgrow="ALWAYS"/>
                <Button text="Search" styleClass="primary-button" onAction="#searchMatchings"/>
            </HBox>

            <!-- Add Matching Button -->
            <Button text="Add New Matching" styleClass="primary-button" onAction="#showCreateMatchingDialog"
                    style="-fx-margin: 0 10 10 10;"/>

            <!-- Matching List -->
            <ListView fx:id="matchingListView" styleClass="matching-list" VBox.vgrow="ALWAYS"/>
        </VBox>
    </left>

    <!-- Center - Chat Area -->
    <center>
        <VBox spacing="10">
            <!-- Chat Header -->
            <HBox styleClass="chat-header" alignment="CENTER_LEFT">
                <ImageView fitHeight="40" fitWidth="40" preserveRatio="true">
                    <image>
                        <Image url="@/images/avatar.png"/>
                    </image>
                </ImageView>
                <VBox style="-fx-padding: 0 0 0 10;">
                    <Label fx:id="matchingNameLabel" style="-fx-font-weight: bold;"/>
                    <Label fx:id="matchingSubjectLabel" style="-fx-text-fill: #6c757d; -fx-font-size: 12;"/>
                </VBox>
                <Button fx:id="editMatchingButton" styleClass="icon-button" onAction="#showEditMatchingDialog">
                    <graphic>
                        <ImageView fitHeight="16" fitWidth="16">
                            <image>
                                <Image url="@/images/cog.png"/>
                            </image>
                        </ImageView>
                    </graphic>
                </Button>
            </HBox>

            <!-- Messages -->
            <ListView fx:id="messageListView" styleClass="message-list" VBox.vgrow="ALWAYS"/>

            <!-- Message Input -->
            <HBox style="-fx-padding: 10;" spacing="10" alignment="CENTER">
                <TextArea fx:id="messageTextArea" promptText="Type your message..." styleClass="message-input" HBox.hgrow="ALWAYS"/>
                <Button text="Correct" styleClass="secondary-button" onAction="#correctMessage"/>
                <Button text="Send" styleClass="primary-button" onAction="#sendMessage"/>
            </HBox>
        </VBox>
    </center>
</BorderPane>